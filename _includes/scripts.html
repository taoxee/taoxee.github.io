{% if site.footer_scripts %}
  {% for script in site.footer_scripts %}
    <script src="{{ script | relative_url }}"></script>
  {% endfor %}
{% else %}
  <script src="{{ '/assets/js/main.min.js' | relative_url }}"></script>
{% endif %}

{% if site.search == true or page.layout == "search" %}
  {%- assign search_provider = site.search_provider | default: "lunr" -%}
  {%- case search_provider -%}
    {%- when "lunr" -%}
      {% include_cached search/lunr-search-scripts.html %}
    {%- when "google" -%}
      {% include_cached search/google-search-scripts.html %}
    {%- when "algolia" -%}
      {% include_cached search/algolia-search-scripts.html %}
  {%- endcase -%}
{% endif %}

{% include analytics.html %}
{% include /comments-providers/scripts.html %}

<!-- Language Toggle Functionality -->
<script>
// Language Toggle System
let currentLang = localStorage.getItem('preferred-language') || 'en';

// Translation data
const translations = {
  en: {
    // Navigation
    "Home": "Home",
    "About": "About",
    "Bio": "Bio", 
    "CV": "CV",
    "Posts": "Posts",
    "Contact": "Contact",
    // Homepage
    "Hello, I'm": "Hello, I'm",
    "PMP Certified project manager leading tech and security projects across APAC, passionate about AI, data science, and creating meaningful digital experiences": "PMP Certified project manager leading tech and security projects across APAC, passionate about AI, data science, and creating meaningful digital experiences",
    "What I Do": "What I Do",
    "Project Management": "Project Management",
    "AI & Data Science": "AI & Data Science", 
    "Security & Compliance": "Security & Compliance",
    "Technical Expertise": "Technical Expertise",
    "APAC Leadership": "APAC Leadership",
    "Research & Education": "Research & Education",
    // Common
    "Get Started": "Get Started",
    "Learn More": "Learn More",
    "Learn About Me": "Learn About Me",
    "Contact Me": "Contact Me",
    "Download CV": "Download CV",
    "View My CV": "View My CV",
    "Ready to Collaborate?": "Ready to Collaborate?",
    "I'm always interested in innovative projects and meaningful collaborations": "I'm always interested in innovative projects and meaningful collaborations",
    "Get in Touch": "Get in Touch"
  },
  zh: {
    // Navigation
    "Home": "首页",
    "About": "关于", 
    "Bio": "简历",
    "CV": "履历",
    "Posts": "文章",
    "Contact": "联系",
    // Homepage
    "Hello, I'm": "你好，我是",
    "PMP Certified project manager leading tech and security projects across APAC, passionate about AI, data science, and creating meaningful digital experiences": "PMP认证项目经理，领导亚太地区技术和安全项目，热衷于人工智能、数据科学和创造有意义的数字体验",
    "What I Do": "我的专长",
    "Project Management": "项目管理",
    "AI & Data Science": "人工智能与数据科学",
    "Security & Compliance": "安全与合规",
    "Technical Expertise": "技术专长",
    "APAC Leadership": "亚太区领导力",
    "Research & Education": "研究与教育",
    // Common
    "Get Started": "开始",
    "Learn More": "了解更多",
    "Learn About Me": "了解我",
    "Contact Me": "联系我",
    "Download CV": "下载简历",
    "View My CV": "查看简历",
    "Ready to Collaborate?": "准备合作了吗？",
    "I'm always interested in innovative projects and meaningful collaborations": "我总是对创新项目和有意义的合作感兴趣",
    "Get in Touch": "联系我"
  }
};

// Function to toggle language
function toggleLanguage() {
  currentLang = currentLang === 'en' ? 'zh' : 'en';
  localStorage.setItem('preferred-language', currentLang);
  updatePageLanguage();
  updateToggleButton();
}

// Function to update page content
function updatePageLanguage() {
  const elements = document.querySelectorAll('[data-translate]');
  elements.forEach(element => {
    const key = element.getAttribute('data-translate');
    if (translations[currentLang] && translations[currentLang][key]) {
      element.textContent = translations[currentLang][key];
    }
  });
}

// Function to update toggle button
function updateToggleButton() {
  const langText = document.getElementById('lang-text');
  if (langText) {
    langText.textContent = currentLang === 'en' ? '中文' : 'English';
  }
}

// Initialize language on page load
document.addEventListener('DOMContentLoaded', function() {
  updatePageLanguage();
  updateToggleButton();
});

// Auto-detect browser language on first visit
if (!localStorage.getItem('preferred-language')) {
  const browserLang = navigator.language || navigator.userLanguage;
  if (browserLang.startsWith('zh')) {
    currentLang = 'zh';
    localStorage.setItem('preferred-language', 'zh');
    updatePageLanguage();
    updateToggleButton();
  }
}
</script>

{% if site.after_footer_scripts %}
  {% for script in site.after_footer_scripts %}
    <script src="{{ script | relative_url }}"></script>
  {% endfor %}
{% endif %}
